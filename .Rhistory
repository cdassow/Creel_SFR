facet_wrap(~species,scales = 'free')
# length distributions of fish caught through time
ggplot(fd)+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(year~species,scales = 'free')
# length distributions of fish caught through time
ggplot(fd)+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(species~year,scales = 'free')
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')y+
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year)
msk
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
npk=ggplot(fd[fd$species=='northern_pike',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
npk
fd[fd$species=='northern_pike' & fd$year==2009,]
# basic data descriptions for only the data on musky, pike, and bass
fd=expand_counts(fdat)
fd=fdat[fdat$species%in%c('muskellunge','northern_pike','largemouth_bass'),]
lmb=ggplot(fd[fd$species=='largemouth_bass',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
lmb
table(fdat$age)
unique(fdat$age)
# age distributions of fish caught through time
la=get_fmdb_lenage(wbic=c(mud,cal))
View(la)
la=la[la$wbic%in%c(mud,cal),]
head(la)
unique(la$species)
ggplot(la[la$species=='muskellunge',])+theme_classic()+
geom_point(aes(y=age,x=length))
ggplot(la[la$species=='muskellunge',])+theme_classic()+
geom_point(aes(y=age,x=length))
la[la$species=='muskellunge',]
unique(la$age[la$species=='muskellunge'])
library(openxlsx)
# look at musky age and growth project information
magp=read.xlsx('C:/Users/dassocju/OneDrive - State of Wisconsin/Office_of_Applied_Science/Musky_Age_and_Growth/data/cleaned_CJD/2024-11-27_pitAtLarge_standardized.xlsx',detectDates = T,colNames = T)
mc=magp[magp$wbic%in%c(muc,cal),]
mc=magp[magp$wbic%in%c(mud,cal),]
View(mc)
msk
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'magma')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'plasma')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
npk=ggplot(fd[fd$species=='northern_pike',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
npk
lmb=ggplot(fd[fd$species=='largemouth_bass',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
lmb
length(unique(mc$pitNumber))
sort(table(mc$pitNumber))
table(mc$age)
table(mc$sex)
table(fd$sex[fd$species=='muskellunge',])
table(fd$sex[fd$species=='muskellunge'])
92/57
175/121
table(sto$species)
unique(sto$wbic)
# stocking history
mcsto=sto[sto$wbic%in%c(mud,cal),]
View(mcsto)
rm(list=ls())
library(wdnr.fmdb)
library(tidyverse)
library(openxlsx)
# pull in all fish data for Mud-Callahan
mud=2434800
cal=2434700
fdat=get_fmdb_fishraw(wbic=c(mud,cal))
edat=get_fmdb_efforts(wbic=c(mud,cal))
sdat=get_fmdb_surveys(wbic=c(mud,cal))
sto=get_fmdb_stocking(wbic=c(mud,cal))
lchar=get_fmdb_lakechar()
# basic data descriptions for only the data on musky, pike, and bass
fd=expand_counts(fdat)
fd=fdat[fdat$species%in%c('muskellunge','northern_pike','largemouth_bass'),]
range(fd$year)
#survey effort through time
edp=edat%>%
select(sample.date,gear,total.sample.time,total.sample.minutes,number.of.nets,hours.set,distance.shocked,distance.units)%>%
mutate(year=year(sample.date))
edp$number.of.nets[edp$gear=='fyke_net'& is.na(edp$hours.set)]=0 # making unknown net numbers 0 so they still get plotted on timeline
edp$hours.set[edp$gear=='fyke_net'& is.na(edp$hours.set)]=0 # making years without known effort 0 so they still get plotted
edp$distance.shocked[edp$gear=='boom_shocker' & is.na(edp$distance.shocked)]=0 # making years without known distance shocked 0 so they still get plotted
fyke=ggplot(edp[edp$gear=='fyke_net',])+theme_classic()+
geom_point(aes(x=year,y=hours.set*number.of.nets))+
geom_col(aes(x=year,y=hours.set*number.of.nets))+
labs(x='Year',y='Hours of Netting Effort',title='Fyke Netting on Mud - Callahan, Sawyer Co.')+theme(panel.grid.major.y = element_line())+
scale_x_continuous(breaks = seq(1945,2025,by=5))+
scale_y_continuous(breaks = seq(0,1500,by=200))
fyke
shock=ggplot(edp[edp$gear=='boom_shocker',])+theme_classic()+
geom_point(aes(x=year,y=distance.shocked))+
geom_col(aes(x=year,y=distance.shocked))+
labs(x='Year',y='Miles of Shoreline',title='Electrofishing on Mud - Callahan, Sawyer Co.')+theme(panel.grid.major.y = element_line())+
scale_x_continuous(breaks = seq(1945,2025,by=5))
shock
# catch rates of the focal species through time
cpes=calc_cpe(sdat,edat,fdat)
yrCPEs=cpes%>%
filter(species%in%c('muskellunge','northern_pike','largemouth_bass'))%>%
group_by(year,gear,species,cpe_type,cpe_units)%>%
summarise(avgCPE=mean(cpe),
sdCPE=sd(cpe))
ggplot(yrCPEs)+theme_bw()+
geom_pointrange(aes(x=year,y=avgCPE,ymin=avgCPE-sdCPE,ymax=avgCPE+sdCPE))+
geom_line(aes(x=year,y=avgCPE))+
scale_x_continuous(breaks = seq(2005,2025,by=2))+
theme(axis.text.x = element_text(angle = -45,hjust = 0))+
labs(x='Year',y='Average Catch Rate')+
facet_grid(species~cpe_units,scales = 'free_y')
# length distributions of fish caught through time
ggplot(fd)+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(species~year,scales = 'free')
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
npk=ggplot(fd[fd$species=='northern_pike',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
npk
lmb=ggplot(fd[fd$species=='largemouth_bass',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
lmb
# age distributions of fish caught through time
la=get_fmdb_lenage(wbic=c(mud,cal))
la=la[la$wbic%in%c(mud,cal),]
# look at musky age and growth project information
magp=read.xlsx('C:/Users/dassocju/OneDrive - State of Wisconsin/Office_of_Applied_Science/Musky_Age_and_Growth/data/cleaned_CJD/2024-11-27_pitAtLarge_standardized.xlsx',detectDates = T,colNames = T)
mc=magp[magp$wbic%in%c(mud,cal),]
length(unique(mc$pitNumber)) # 132 pit tagged fish out there
# sex information
table(mc$sex) # 1.6 m:f
table(fd$sex[fd$species=='muskellunge']) # 1.2 m:f
# stocking history
mcsto=sto[sto$wbic%in%c(mud,cal),]
range(fd$year)
range(fd$year[fd$species=='northern_pike'])
fyke=ggplot(edp[edp$gear=='fyke_net',])+theme_classic()+
geom_point(aes(x=year,y=hours.set*number.of.nets))+
geom_col(aes(x=year,y=hours.set*number.of.nets))+
labs(x='Year',y='Hours of Netting Effort',title='Fyke Netting on Mud - Callahan, Sawyer Co.')+theme(panel.grid.major.y = element_line())+
scale_x_continuous(breaks = seq(1945,2025,by=5))+
scale_y_continuous(breaks = seq(0,1500,by=200))
fyke
sort(table(fd$year))
52+71+94+115+140+165
637/nrow(fd)
shock=ggplot(edp[edp$gear=='boom_shocker',])+theme_classic()+
geom_point(aes(x=year,y=distance.shocked))+
geom_col(aes(x=year,y=distance.shocked))+
labs(x='Year',y='Miles of Shoreline',title='Electrofishing on Mud - Callahan, Sawyer Co.')+theme(panel.grid.major.y = element_line())+
scale_x_continuous(breaks = seq(1945,2025,by=5))
shock
# catch rates of the focal species through time
cpes=calc_cpe(sdat,edat,fdat)
yrCPEs=cpes%>%
filter(species%in%c('muskellunge','northern_pike','largemouth_bass'))%>%
group_by(year,gear,species,cpe_type,cpe_units)%>%
summarise(avgCPE=mean(cpe),
sdCPE=sd(cpe))
ggplot(yrCPEs)+theme_bw()+
geom_pointrange(aes(x=year,y=avgCPE,ymin=avgCPE-sdCPE,ymax=avgCPE+sdCPE))+
geom_line(aes(x=year,y=avgCPE))+
scale_x_continuous(breaks = seq(2005,2025,by=2))+
theme(axis.text.x = element_text(angle = -45,hjust = 0))+
labs(x='Year',y='Average Catch Rate')+
facet_grid(species~cpe_units,scales = 'free_y')
sort(table(fd$year[fd$species=='northern_pike']))
# length distributions of fish caught through time
ggplot(fd)+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)),alpha=0.2)+
scale_fill_viridis_d()+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(species~year,scales = 'free')
msk=ggplot(fd[fd$species=='muskellunge',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
msk
npk=ggplot(fd[fd$species=='northern_pike',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
ggplot(yrCPEs)+theme_bw()+
geom_pointrange(aes(x=year,y=avgCPE,ymin=avgCPE-sdCPE,ymax=avgCPE+sdCPE))+
geom_line(aes(x=year,y=avgCPE))+
scale_x_continuous(breaks = seq(2005,2025,by=2))+
theme(axis.text.x = element_text(angle = -45,hjust = 0))+
labs(x='Year',y='Average Catch Rate')+
facet_grid(species~cpe_units,scales = 'free_y')
npk
lmb=ggplot(fd[fd$species=='largemouth_bass',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
lmb
View(magp)
View(mc)
yrCPEs=cpes%>%
filter(species%in%c('muskellunge','northern_pike','largemouth_bass'))%>%
group_by(year,gear,species,cpe_type,cpe_units)%>%
summarise(avgCPE=mean(cpe),
sdCPE=sd(cpe))
ggplot(yrCPEs)+theme_bw()+
geom_pointrange(aes(x=year,y=avgCPE,ymin=avgCPE-sdCPE,ymax=avgCPE+sdCPE))+
geom_line(aes(x=year,y=avgCPE))+
scale_x_continuous(breaks = seq(2005,2025,by=2))+
theme(axis.text.x = element_text(angle = -45,hjust = 0))+
labs(x='Year',y='Average Catch Rate')+
facet_grid(species~cpe_units,scales = 'free_y')
lmb=ggplot(fd[fd$species=='largemouth_bass',])+theme_classic()+
geom_histogram(aes(x=length,fill=as.factor(year)))+
scale_fill_viridis_d(option = 'turbo')+
labs(x='Length (in)',y='Number Caught',fill='Year')+
facet_wrap(~year,ncol = 1)
lmb
npk
msk
lmb
npk
ggplot(yrCPEs)+theme_bw()+
geom_pointrange(aes(x=year,y=avgCPE,ymin=avgCPE-sdCPE,ymax=avgCPE+sdCPE))+
geom_line(aes(x=year,y=avgCPE))+
scale_x_continuous(breaks = seq(2005,2025,by=2))+
theme(axis.text.x = element_text(angle = -45,hjust = 0))+
labs(x='Year',y='Average Catch Rate')+
facet_grid(species~cpe_units,scales = 'free_y')
rm(list=ls())
library(tidyverse)
# read in year by year RDS objects
setwd("C:/Users/dassocju/Documents/OAS_git_repos/Creel_SFR")
expR=readRDS('yearLoopOutput_3.6.25.RData')
harvR=readRDS('yearLoopOutput_harvestR_4.4.25.RData')
eff=readRDS('yearLoopOutput_effort_4.4.25.RData')
catch=readRDS('yearLoopOutput_catch_4.4.25.RData')
hrv=readRDS('yearLoopOutput_harvest_4.4.25.RData')
# calculate a percentage of years with non-sig diffs by data scenario to present in a table.
# unpack RDS objects
bpval.self.y.expR=expR[[1]]
bpval.self.y.expR=bpval.self.y.expR[!is.na(bpval.self.y.expR$scenario),]
bpval.comp.y.expR=expR[[2]]
bpval.comp.y.expR=bpval.comp.y.expR[!is.na(bpval.comp.y.expR$scenario),]
grMetrics.y.expR=expR[[3]]
grMetrics.y.expR=grMetrics.y.expR[!is.na(grMetrics.y.expR$scenario),]
bpval.self.y.harvR=harvR[[1]]
bpval.self.y.harvR=bpval.self.y.harvR[!is.na(bpval.self.y.harvR$scenario),]
bpval.comp.y.harvR=harvR[[2]]
bpval.comp.y.harvR=bpval.comp.y.harvR[!is.na(bpval.comp.y.harvR$scenario),]
grMetrics.y.harvR=harvR[[3]]
grMetrics.y.harvR=grMetrics.y.harvR[!is.na(grMetrics.y.harvR$scenario),]
bpval.self.y.eff=eff[[1]]
bpval.self.y.eff=bpval.self.y.eff[!is.na(bpval.self.y.eff$scenario),]
bpval.comp.y.eff=eff[[2]]
bpval.comp.y.eff=bpval.comp.y.eff[!is.na(bpval.comp.y.eff$scenario),]
grMetrics.y.eff=eff[[3]]
grMetrics.y.eff=grMetrics.y.eff[!is.na(grMetrics.y.eff$scenario),]
bpval.self.y.catch=catch[[1]]
bpval.self.y.catch=bpval.self.y.catch[!is.na(bpval.self.y.catch$scenario),]
bpval.comp.y.catch=catch[[2]]
bpval.comp.y.catch=bpval.comp.y.catch[!is.na(bpval.comp.y.catch$scenario),]
grMetrics.y.catch=catch[[3]]
grMetrics.y.catch=grMetrics.y.catch[!is.na(grMetrics.y.catch$scenario),]
bpval.self.y.hrv=hrv[[1]]
bpval.self.y.hrv=bpval.self.y.hrv[!is.na(bpval.self.y.hrv$scenario),]
bpval.comp.y.hrv=hrv[[2]]
bpval.comp.y.hrv=bpval.comp.y.hrv[!is.na(bpval.comp.y.hrv$scenario),]
grMetrics.y.hrv=hrv[[3]]
grMetrics.y.hrv=grMetrics.y.hrv[!is.na(grMetrics.y.hrv$scenario),]
# combine dfs into relevant global dfs
metric=c(rep('expR',nrow(bpval.self.y.expR)),
rep('harvR',nrow(bpval.self.y.harvR)),
rep('eff',nrow(bpval.self.y.eff)),
rep('catch',nrow(bpval.self.y.catch)),
rep('hrv',nrow(bpval.self.y.hrv)))
global.bpval.self.y=as.data.frame(cbind(metric,
rbind(bpval.self.y.expR,
bpval.self.y.harvR,
bpval.self.y.eff,
bpval.self.y.catch,
bpval.self.y.hrv)))
metric=c(rep('expR',nrow(bpval.comp.y.expR)),
rep('harvR',nrow(bpval.comp.y.harvR)),
rep('eff',nrow(bpval.comp.y.eff)),
rep('catch',nrow(bpval.comp.y.catch)),
rep('hrv',nrow(bpval.comp.y.hrv)))
global.bpval.comp.y=as.data.frame(cbind(metric,
rbind(bpval.comp.y.expR,
bpval.comp.y.harvR,
bpval.comp.y.eff,
bpval.comp.y.catch,
bpval.comp.y.hrv)))
metric=c(rep('expR',nrow(grMetrics.y.expR)),
rep('harvR',nrow(grMetrics.y.harvR)),
rep('eff',nrow(grMetrics.y.eff)),
rep('catch',nrow(grMetrics.y.catch)),
rep('hrv',nrow(grMetrics.y.hrv)))
global.grMetrics.y=as.data.frame(cbind(metric,
rbind(grMetrics.y.expR,
grMetrics.y.harvR,
grMetrics.y.eff,
grMetrics.y.catch,
grMetrics.y.hrv)))
global.grMetrics.y=global.grMetrics.y[!is.na(global.grMetrics.y$gr.prsf),]
# summary tables
selfCompTabl=global.bpval.self.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.cv=(sum(coef.var.pval>=0.1 & coef.var.pval<=0.9)/n())*100,
percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideSelfCompTab.cv=pivot_wider(selfCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.cv)
actualCompTabl=global.bpval.comp.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.cv=(sum(coef.var.pval>=0.1 & coef.var.pval<=0.9)/n())*100,
percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideActualCompTab.cv=pivot_wider(actualCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.cv)
wideActualCompTab.sd=pivot_wider(actualCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.sd)
grMetricCompTabl=global.grMetrics.y%>%
group_by(metric,scenario)%>%
summarise(percConverged=(sum(gr.prsf<1.1,na.rm = T)/n())*100)
widegrCompTab=pivot_wider(grMetricCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percConverged)
# do some independent spot checks using the original data objects to make sure these numbers are right before adding them in.
# and the spot checks turn out right so these tables are good to go.
556+423
979+139
139/1118
View(wideSelfCompTab.cv)
View(wideActualCompTab.cv)
rm(list=ls())
library(tidyverse)
# read in year by year RDS objects
setwd("C:/Users/dassocju/Documents/OAS_git_repos/Creel_SFR")
expR=readRDS('yearLoopOutput_explRate_8.19.25.RData')
harvR=readRDS('yearLoopOutput_harvestR_8.20.25.RData')
eff=readRDS('yearLoopOutput_effort_8.20.25.RData')
catch=readRDS('yearLoopOutput_walleyecatch_8.19.25.RData')
hrv=readRDS('yearLoopOutput_harvest_8.20.25.RData')
# calculate a percentage of years with non-sig diffs by data scenario to present in a table.
# unpack RDS objects
bpval.self.y.expR=expR[[1]]
bpval.self.y.expR=bpval.self.y.expR[!is.na(bpval.self.y.expR$scenario),]
bpval.comp.y.expR=expR[[2]]
bpval.comp.y.expR=bpval.comp.y.expR[!is.na(bpval.comp.y.expR$scenario),]
grMetrics.y.expR=expR[[3]]
grMetrics.y.expR=grMetrics.y.expR[!is.na(grMetrics.y.expR$scenario),]
bpval.self.y.harvR=harvR[[1]]
bpval.self.y.harvR=bpval.self.y.harvR[!is.na(bpval.self.y.harvR$scenario),]
bpval.comp.y.harvR=harvR[[2]]
bpval.comp.y.harvR=bpval.comp.y.harvR[!is.na(bpval.comp.y.harvR$scenario),]
grMetrics.y.harvR=harvR[[3]]
grMetrics.y.harvR=grMetrics.y.harvR[!is.na(grMetrics.y.harvR$scenario),]
bpval.self.y.eff=eff[[1]]
bpval.self.y.eff=bpval.self.y.eff[!is.na(bpval.self.y.eff$scenario),]
bpval.comp.y.eff=eff[[2]]
bpval.comp.y.eff=bpval.comp.y.eff[!is.na(bpval.comp.y.eff$scenario),]
grMetrics.y.eff=eff[[3]]
grMetrics.y.eff=grMetrics.y.eff[!is.na(grMetrics.y.eff$scenario),]
bpval.self.y.catch=catch[[1]]
bpval.self.y.catch=bpval.self.y.catch[!is.na(bpval.self.y.catch$scenario),]
bpval.comp.y.catch=catch[[2]]
bpval.comp.y.catch=bpval.comp.y.catch[!is.na(bpval.comp.y.catch$scenario),]
grMetrics.y.catch=catch[[3]]
grMetrics.y.catch=grMetrics.y.catch[!is.na(grMetrics.y.catch$scenario),]
bpval.self.y.hrv=hrv[[1]]
bpval.self.y.hrv=bpval.self.y.hrv[!is.na(bpval.self.y.hrv$scenario),]
bpval.comp.y.hrv=hrv[[2]]
bpval.comp.y.hrv=bpval.comp.y.hrv[!is.na(bpval.comp.y.hrv$scenario),]
grMetrics.y.hrv=hrv[[3]]
grMetrics.y.hrv=grMetrics.y.hrv[!is.na(grMetrics.y.hrv$scenario),]
# combine dfs into relevant global dfs
metric=c(rep('expR',nrow(bpval.self.y.expR)),
rep('harvR',nrow(bpval.self.y.harvR)),
rep('eff',nrow(bpval.self.y.eff)),
rep('catch',nrow(bpval.self.y.catch)),
rep('hrv',nrow(bpval.self.y.hrv)))
global.bpval.self.y=as.data.frame(cbind(metric,
rbind(bpval.self.y.expR,
bpval.self.y.harvR,
bpval.self.y.eff,
bpval.self.y.catch,
bpval.self.y.hrv)))
metric=c(rep('expR',nrow(bpval.comp.y.expR)),
rep('harvR',nrow(bpval.comp.y.harvR)),
rep('eff',nrow(bpval.comp.y.eff)),
rep('catch',nrow(bpval.comp.y.catch)),
rep('hrv',nrow(bpval.comp.y.hrv)))
global.bpval.comp.y=as.data.frame(cbind(metric,
rbind(bpval.comp.y.expR,
bpval.comp.y.harvR,
bpval.comp.y.eff,
bpval.comp.y.catch,
bpval.comp.y.hrv)))
metric=c(rep('expR',nrow(grMetrics.y.expR)),
rep('harvR',nrow(grMetrics.y.harvR)),
rep('eff',nrow(grMetrics.y.eff)),
rep('catch',nrow(grMetrics.y.catch)),
rep('hrv',nrow(grMetrics.y.hrv)))
global.grMetrics.y=as.data.frame(cbind(metric,
rbind(grMetrics.y.expR,
grMetrics.y.harvR,
grMetrics.y.eff,
grMetrics.y.catch,
grMetrics.y.hrv)))
global.grMetrics.y=global.grMetrics.y[!is.na(global.grMetrics.y$gr.prsf),]
# summary tables
selfCompTabl=global.bpval.self.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.cv=(sum(coef.var.pval>=0.1 & coef.var.pval<=0.9)/n())*100,
percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideSelfCompTab.cv=pivot_wider(selfCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.cv)
actualCompTabl=global.bpval.comp.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.cv=(sum(coef.var.pval>=0.1 & coef.var.pval<=0.9)/n())*100,
percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideActualCompTab.cv=pivot_wider(actualCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.cv)
wideActualCompTab.sd=pivot_wider(actualCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.sd)
wideSelfCompTab.sd=pivot_wider(selfCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.sd)
View(wideSelfCompTab.sd)
View(wideSelfCompTab.sd)
View(wideActualCompTab.sd)
View(wideActualCompTab.sd)
