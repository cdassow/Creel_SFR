lm.exp.wd25=lm(exp.rate_wd25~exp.rate_actual, data=widetrL.exp, offset=exp.rate_actual)
pv.exp.wd25=signif(summary(lm.exp.wd25)$coefficients[2,4],3)
lm.exp.wd50=lm(exp.rate_wd50~exp.rate_actual, data=widetrL.exp, offset=exp.rate_actual)
pv.exp.wd50=signif(summary(lm.exp.wd50)$coefficients[2,4],3)
lm.exp.we50=lm(exp.rate_we50~exp.rate_actual, data=widetrL.exp, offset=exp.rate_actual)
pv.exp.we50=signif(summary(lm.exp.we50)$coefficients[2,4],3)
lm.harvR.nw=lm(meanHarvR_noWinter~meanHarvR_actual, data=widetrL.harvR, offset=meanHarvR_actual)
pv.harvR.nw=signif(summary(lm.harvR.nw)$coefficients[2,4],3)
lm.harvR.ma=lm(meanHarvR_mayAug~meanHarvR_actual, data=widetrL.harvR, offset=meanHarvR_actual)
pv.harvR.ma=signif(summary(lm.harvR.ma)$coefficients[2,4],3)
lm.harvR.wd25=lm(meanHarvR_wd25~meanHarvR_actual, data=widetrL.harvR, offset=meanHarvR_actual)
pv.harvR.wd25=signif(summary(lm.harvR.wd25)$coefficients[2,4],3)
lm.harvR.wd50=lm(meanHarvR_wd50~meanHarvR_actual, data=widetrL.harvR, offset=meanHarvR_actual)
pv.harvR.wd50=signif(summary(lm.harvR.wd50)$coefficients[2,4],3)
lm.harvR.we50=lm(meanHarvR_we50~meanHarvR_actual, data=widetrL.harvR, offset=meanHarvR_actual)
pv.harvR.we50=signif(summary(lm.harvR.we50)$coefficients[2,4],3)
lm.harv.nw=lm(noWinter~actual, data=widetrL.harv, offset=actual)
pv.harv.nw=signif(summary(lm.harv.nw)$coefficients[2,4],3)
lm.harv.ma=lm(mayAug~actual, data=widetrL.harv, offset=actual)
pv.harv.ma=signif(summary(lm.harv.ma)$coefficients[2,4],3)
lm.harv.wd25=lm(wd25~actual, data=widetrL.harv, offset=actual)
pv.harv.wd25=signif(summary(lm.harv.wd25)$coefficients[2,4],3)
lm.harv.wd50=lm(wd50~actual, data=widetrL.harv, offset=actual)
pv.harv.wd50=signif(summary(lm.harv.wd50)$coefficients[2,4],3)
lm.harv.we50=lm(we50~actual, data=widetrL.harv, offset=actual)
pv.harv.we50=signif(summary(lm.harv.we50)$coefficients[2,4],3)
lm.catch.nw=lm(noWinter~actual, data=widetrL.catch, offset=actual)
pv.catch.nw=signif(summary(lm.catch.nw)$coefficients[2,4],3)
lm.catch.ma=lm(mayAug~actual, data=widetrL.catch, offset=actual)
pv.catch.ma=signif(summary(lm.catch.ma)$coefficients[2,4],3)
lm.catch.wd25=lm(wd25~actual, data=widetrL.catch, offset=actual)
pv.catch.wd25=signif(summary(lm.catch.wd25)$coefficients[2,4],3)
lm.catch.wd50=lm(wd50~actual, data=widetrL.catch, offset=actual)
pv.catch.wd50=signif(summary(lm.catch.wd50)$coefficients[2,4],3)
lm.catch.we50=lm(we50~actual, data=widetrL.catch, offset=actual)
pv.catch.we50=signif(summary(lm.catch.we50)$coefficients[2,4],3)
lm.eff.nw=lm(noWinter~actual, data=widetrL.eff, offset=actual)
pv.eff.nw=signif(summary(lm.eff.nw)$coefficients[2,4],3)
lm.eff.ma=lm(mayAug~actual, data=widetrL.eff, offset=actual)
pv.eff.ma=signif(summary(lm.eff.ma)$coefficients[2,4],3)
lm.eff.wd25=lm(wd25~actual, data=widetrL.eff, offset=actual)
pv.eff.wd25=signif(summary(lm.eff.wd25)$coefficients[2,4],3)
lm.eff.wd50=lm(wd50~actual, data=widetrL.eff, offset=actual)
pv.eff.wd50=signif(summary(lm.eff.wd50)$coefficients[2,4],3)
lm.eff.we50=lm(we50~actual, data=widetrL.eff, offset=actual)
pv.eff.we50=signif(summary(lm.eff.we50)$coefficients[2,4],3)
ep.nw=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.nw,sep='='), x=0.3,y=0.05)+
labs(x="",y='No Winter', title = 'Exploitation Rate')
ep.ma=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.ma,sep='='), x=0.3,y=0.05)+
labs(x="",y='May - August')
ep.wd25=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.wd25,sep='='), x=0.3,y=0.05)+
labs(x="",y='25% Weekday removed')
ep.wd50=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.wd50,sep='='), x=0.3,y=0.05)+
labs(x="",y='50% Weekday removed')
ep.we50=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.we50,sep='='), x=0.3,y=0.05)+
labs(x="Full Creel",y='50% Weekend removed')
e.plots=ggpubr::ggarrange(ep.nw,ep.ma,ep.wd25,ep.wd50,ep.we50, nrow = 5)
hrp.nw=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.nw,sep='='), x=0.4,y=0.05)+
labs(x="",y='No Winter', title = 'Harvest Rate')
hrp.ma=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.ma,sep='='), x=0.4,y=0.05)+
labs(x="",y='May - August')
hrp.wd25=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.wd25,sep='='), x=0.4,y=0.05)+
labs(x="",y='25% Weekday removed')
hrp.wd50=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.wd50,sep='='), x=0.4,y=0.05)+
labs(x="",y='50% Weekday removed')
hrp.we50=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.we50,sep='='), x=0.4,y=0.05)+
labs(x="Full Creel",y='50% Weekend removed')
hr.plots=ggpubr::ggarrange(hrp.nw,hrp.ma,hrp.wd25,hrp.wd50,hrp.we50, nrow = 5)
hp.nw=ggplot(widetrL.harv, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.nw,sep='='), x=17,y=2)+
labs(x="",y='No Winter', title = 'Harvest')
hp.ma=ggplot(widetrL.harv, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.ma,sep='='), x=17,y=2)+
labs(x="",y='May - August')
hp.wd25=ggplot(widetrL.harv, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.wd25,sep='='), x=17,y=2)+
labs(x="",y='25% Weekday removed')
hp.wd50=ggplot(widetrL.harv, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.wd50,sep='='), x=17,y=2)+
labs(x="",y='50% Weekday removed')
hp.we50=ggplot(widetrL.harv, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.we50,sep='='), x=17,y=2)+
labs(x="Full Creel",y='50% Weekend removed')
h.plots=ggpubr::ggarrange(hp.nw,hp.ma,hp.wd25,hp.wd50,hp.we50, nrow = 5)
cp.nw=ggplot(widetrL.catch, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.nw,sep='='), x=45,y=5)+
labs(x="",y='No Winter', title = 'Catch')
cp.ma=ggplot(widetrL.catch, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.ma,sep='='), x=45,y=5)+
labs(x="",y='May - August')
cp.wd25=ggplot(widetrL.catch, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.wd25,sep='='), x=45,y=5)+
labs(x="",y='25% Weekday removed')
cp.wd50=ggplot(widetrL.catch, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.wd50,sep='='), x=45,y=5)+
labs(x="",y='50% Weekday removed')
cp.we50=ggplot(widetrL.catch, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.we50,sep='='), x=45,y=5)+
labs(x="Full Creel",y='50% Weekend removed')
catch.plots=ggpubr::ggarrange(cp.nw,cp.ma,cp.wd25,cp.wd50,cp.we50, nrow = 5)
efp.nw=ggplot(widetrL.eff, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.nw,sep='='), x=2500,y=200)+
labs(x="",y='No Winter', title = 'Effort')
efp.ma=ggplot(widetrL.eff, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.ma,sep='='), x=2500,y=200)+
labs(x="",y='May - August')
efp.wd25=ggplot(widetrL.eff, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.wd25,sep='='), x=2500,y=200)+
labs(x="",y='25% Weekday removed')
efp.wd50=ggplot(widetrL.eff, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.wd50,sep='='), x=2500,y=200)+
labs(x="",y='50% Weekday removed')
efp.we50=ggplot(widetrL.eff, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.we50,sep='='), x=2500,y=200)+
labs(x="Full Creel",y='50% Weekend removed')
effort.plots=ggpubr::ggarrange(efp.nw,efp.ma,efp.wd25,efp.wd50,efp.we50, nrow = 5)
bigPanel=ggpubr::ggarrange(e.plots,hr.plots,h.plots,catch.plots,effort.plots, ncol = 5)
bigPanel
sum(!is.na(widetrL.0$noWinter)
)
sum(!is.na(widetrL.0$mayAug))
sum(!is.na(widetrL.0$wd25))
sum(!is.na(widetrL.0$wd50))
sum(!is.na(widetrL.0$we50))
sum(!is.na(widetrL.0$actual))
ep.nw=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('NRMSE',signif(nw.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.nw,sep='='), x=0.3,y=0.05)+
labs(x="",y='No Winter', title = 'Exploitation Rate')
ep.ma=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('NRMSE',signif(ma.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.ma,sep='='), x=0.3,y=0.05)+
labs(x="",y='May - August')
ep.wd25=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('NRMSE',signif(wd25.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.wd25,sep='='), x=0.3,y=0.05)+
labs(x="",y='25% Weekday removed')
ep.wd50=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('NRMSE',signif(wd50.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.wd50,sep='='), x=0.3,y=0.05)+
labs(x="",y='50% Weekday removed')
ep.we50=ggplot(widetrL.exp, aes(x=exp.rate_actual,y=exp.rate_we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('NRMSE',signif(we50.rmse.exp,4),sep='='), x=0.3,y=0.1)+
annotate('text',label=paste('p-value',pv.exp.we50,sep='='), x=0.3,y=0.05)+
labs(x="Full Creel",y='50% Weekend removed')
e.plots=ggpubr::ggarrange(ep.nw,ep.ma,ep.wd25,ep.wd50,ep.we50, nrow = 5)
hrp.nw=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.nw,sep='='), x=0.4,y=0.05)+
labs(x="",y='No Winter', title = 'Harvest Rate')
hrp.ma=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.ma,sep='='), x=0.4,y=0.05)+
labs(x="",y='May - August')
hrp.wd25=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.wd25,sep='='), x=0.4,y=0.05)+
labs(x="",y='25% Weekday removed')
hrp.wd50=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.wd50,sep='='), x=0.4,y=0.05)+
labs(x="",y='50% Weekday removed')
hrp.we50=ggplot(widetrL.harvR, aes(x=meanHarvR_actual,y=meanHarvR_we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.harvR,4),sep='='), x=0.4,y=0.15)+
annotate('text',label=paste('p-value',pv.harvR.we50,sep='='), x=0.4,y=0.05)+
labs(x="Full Creel",y='50% Weekend removed')
hr.plots=ggpubr::ggarrange(hrp.nw,hrp.ma,hrp.wd25,hrp.wd50,hrp.we50, nrow = 5)
hp.nw=ggplot(widetrL.harv, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.nw,sep='='), x=17,y=2)+
labs(x="",y='No Winter', title = 'Harvest')
hp.ma=ggplot(widetrL.harv, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.ma,sep='='), x=17,y=2)+
labs(x="",y='May - August')
hp.wd25=ggplot(widetrL.harv, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.wd25,sep='='), x=17,y=2)+
labs(x="",y='25% Weekday removed')
hp.wd50=ggplot(widetrL.harv, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.wd50,sep='='), x=17,y=2)+
labs(x="",y='50% Weekday removed')
hp.we50=ggplot(widetrL.harv, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.harv,4),sep='='), x=17,y=6)+
annotate('text',label=paste('p-value',pv.harv.we50,sep='='), x=17,y=2)+
labs(x="Full Creel",y='50% Weekend removed')
h.plots=ggpubr::ggarrange(hp.nw,hp.ma,hp.wd25,hp.wd50,hp.we50, nrow = 5)
cp.nw=ggplot(widetrL.catch, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.nw,sep='='), x=45,y=5)+
labs(x="",y='No Winter', title = 'Catch')
cp.ma=ggplot(widetrL.catch, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.ma,sep='='), x=45,y=5)+
labs(x="",y='May - August')
cp.wd25=ggplot(widetrL.catch, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.wd25,sep='='), x=45,y=5)+
labs(x="",y='25% Weekday removed')
cp.wd50=ggplot(widetrL.catch, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.wd50,sep='='), x=45,y=5)+
labs(x="",y='50% Weekday removed')
cp.we50=ggplot(widetrL.catch, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.catch,4),sep='='), x=45,y=20)+
annotate('text',label=paste('p-value',pv.catch.we50,sep='='), x=45,y=5)+
labs(x="Full Creel",y='50% Weekend removed')
catch.plots=ggpubr::ggarrange(cp.nw,cp.ma,cp.wd25,cp.wd50,cp.we50, nrow = 5)
efp.nw=ggplot(widetrL.eff, aes(x=actual,y=noWinter))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(nw.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.nw,sep='='), x=2500,y=200)+
labs(x="",y='No Winter', title = 'Effort')
efp.ma=ggplot(widetrL.eff, aes(x=actual,y=mayAug))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(ma.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.ma,sep='='), x=2500,y=200)+
labs(x="",y='May - August')
efp.wd25=ggplot(widetrL.eff, aes(x=actual,y=wd25))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd25.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.wd25,sep='='), x=2500,y=200)+
labs(x="",y='25% Weekday removed')
efp.wd50=ggplot(widetrL.eff, aes(x=actual,y=wd50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(wd50.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.wd50,sep='='), x=2500,y=200)+
labs(x="",y='50% Weekday removed')
efp.we50=ggplot(widetrL.eff, aes(x=actual,y=we50))+theme_classic()+
geom_point()+
geom_smooth(method = 'lm')+
geom_abline(slope = 1, intercept = 0)+
annotate('text',label=paste('RMSE',signif(we50.rmse.eff,4),sep='='), x=2500,y=900)+
annotate('text',label=paste('p-value',pv.eff.we50,sep='='), x=2500,y=200)+
labs(x="Full Creel",y='50% Weekend removed')
effort.plots=ggpubr::ggarrange(efp.nw,efp.ma,efp.wd25,efp.wd50,efp.we50, nrow = 5)
bigPanel=ggpubr::ggarrange(e.plots,hr.plots,h.plots,catch.plots,effort.plots, ncol = 5)
bigPanel
expR=readRDS('yearLoopOutput_explRate_9.30.25.RData')
harvR=readRDS('yearLoopOutput_harvestR_9.29.25.RData')
eff=readRDS('yearLoopOutput_effort_9.23.25.RData')
catch=readRDS('yearLoopOutput_walleyecatch_9.23.25.RData')
hrv=readRDS('yearLoopOutput_harvest_9.23.25.RData')
# unpack RDS objects
bpval.self.y.expR=expR[[1]]
bpval.self.y.expR=bpval.self.y.expR[!is.na(bpval.self.y.expR$scenario),]
bpval.comp.y.expR=expR[[2]]
bpval.comp.y.expR=bpval.comp.y.expR[!is.na(bpval.comp.y.expR$scenario),]
grMetrics.y.expR=expR[[3]]
grMetrics.y.expR=grMetrics.y.expR[!is.na(grMetrics.y.expR$scenario),]
bpval.self.y.harvR=harvR[[1]]
bpval.self.y.harvR=bpval.self.y.harvR[!is.na(bpval.self.y.harvR$scenario),]
bpval.comp.y.harvR=harvR[[2]]
bpval.comp.y.harvR=bpval.comp.y.harvR[!is.na(bpval.comp.y.harvR$scenario),]
grMetrics.y.harvR=harvR[[3]]
grMetrics.y.harvR=grMetrics.y.harvR[!is.na(grMetrics.y.harvR$scenario),]
bpval.self.y.eff=eff[[1]]
bpval.self.y.eff=bpval.self.y.eff[!is.na(bpval.self.y.eff$scenario),]
bpval.comp.y.eff=eff[[2]]
bpval.comp.y.eff=bpval.comp.y.eff[!is.na(bpval.comp.y.eff$scenario),]
grMetrics.y.eff=eff[[3]]
grMetrics.y.eff=grMetrics.y.eff[!is.na(grMetrics.y.eff$scenario),]
bpval.self.y.catch=catch[[1]]
bpval.self.y.catch=bpval.self.y.catch[!is.na(bpval.self.y.catch$scenario),]
bpval.comp.y.catch=catch[[2]]
bpval.comp.y.catch=bpval.comp.y.catch[!is.na(bpval.comp.y.catch$scenario),]
grMetrics.y.catch=catch[[3]]
grMetrics.y.catch=grMetrics.y.catch[!is.na(grMetrics.y.catch$scenario),]
bpval.self.y.hrv=hrv[[1]]
bpval.self.y.hrv=bpval.self.y.hrv[!is.na(bpval.self.y.hrv$scenario),]
bpval.comp.y.hrv=hrv[[2]]
bpval.comp.y.hrv=bpval.comp.y.hrv[!is.na(bpval.comp.y.hrv$scenario),]
grMetrics.y.hrv=hrv[[3]]
grMetrics.y.hrv=grMetrics.y.hrv[!is.na(grMetrics.y.hrv$scenario),]
# combine dfs into relevant global dfs
metric=c(rep('expR',nrow(bpval.self.y.expR)),
rep('harvR',nrow(bpval.self.y.harvR)),
rep('eff',nrow(bpval.self.y.eff)),
rep('catch',nrow(bpval.self.y.catch)),
rep('hrv',nrow(bpval.self.y.hrv)))
global.bpval.self.y=as.data.frame(cbind(metric,
rbind(bpval.self.y.expR[c('year','scenario','sd.pval')],
bpval.self.y.harvR[c('year','scenario','sd.pval')],
bpval.self.y.eff[c('year','scenario','sd.pval')],
bpval.self.y.catch[c('year','scenario','sd.pval')],
bpval.self.y.hrv[c('year','scenario','sd.pval')])))
metric=c(rep('expR',nrow(bpval.comp.y.expR)),
rep('harvR',nrow(bpval.comp.y.harvR)),
rep('eff',nrow(bpval.comp.y.eff)),
rep('catch',nrow(bpval.comp.y.catch)),
rep('hrv',nrow(bpval.comp.y.hrv)))
global.bpval.comp.y=as.data.frame(cbind(metric,
rbind(bpval.comp.y.expR[c('year','scenario','sd.pval')],
bpval.comp.y.harvR[c('year','scenario','sd.pval')],
bpval.comp.y.eff[c('year','scenario','sd.pval')],
bpval.comp.y.catch[c('year','scenario','sd.pval')],
bpval.comp.y.hrv[c('year','scenario','sd.pval')])))
metric=c(rep('expR',nrow(grMetrics.y.expR)),
rep('harvR',nrow(grMetrics.y.harvR)),
rep('eff',nrow(grMetrics.y.eff)),
rep('catch',nrow(grMetrics.y.catch)),
rep('hrv',nrow(grMetrics.y.hrv)))
global.grMetrics.y=as.data.frame(cbind(metric,
rbind(grMetrics.y.expR,
grMetrics.y.harvR,
grMetrics.y.eff,
grMetrics.y.catch,
grMetrics.y.hrv)))
global.grMetrics.y=global.grMetrics.y[!is.na(global.grMetrics.y$gr.prsf),]
# summary tables
selfCompTabl=global.bpval.self.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideSelfCompTab.sd=pivot_wider(selfCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.sd)
actualCompTabl=global.bpval.comp.y%>%
group_by(metric,scenario)%>%
summarise(percNONsig.sd=(sum(sd.pval>=0.1 & sd.pval<=0.9)/n())*100)
wideActualCompTab.sd=pivot_wider(actualCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percNONsig.sd)
grMetricCompTabl=global.grMetrics.y%>%
group_by(metric,scenario)%>%
summarise(percConverged=(sum(gr.prsf<1.1,na.rm = T)/n())*100)
widegrCompTab=pivot_wider(grMetricCompTabl,
id_cols = scenario,
names_from = metric,
values_from = percConverged)
head(actualCompTabl)
mean(actualCompTabl$percNONsig.sd[actualCompTabl$scenario!='Actual'])
